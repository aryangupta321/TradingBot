//@version=5
strategy("Scalping RSI+MACD", overlay=true, initial_capital=1000, default_qty_type=strategy.percent_of_equity, default_qty_value=10)

// Settings
rsi_period = 14
rsi_oversold = 30
rsi_overbought = 70

// Calculate RSI
rsi = ta.rsi(close, rsi_period)

// Calculate MACD
[macdLine, signalLine, _] = ta.macd(close, 12, 26, 9)

// Pre-calculate crossovers (IMPORTANT FOR PINE v5)
macd_cross_up = ta.crossover(macdLine, signalLine)
macd_cross_down = ta.crossunder(macdLine, signalLine)

// Buy Signal: RSI < 30 AND MACD crosses up
if rsi < rsi_oversold and macd_cross_up
    strategy.entry("BUY", strategy.long)
    alert("BUY: RSI=" + str.tostring(rsi, "0.00") + " MACD Crossover", alert.freq_once_per_bar_close)

// Sell Signal: RSI > 70 AND MACD crosses down  
if rsi > rsi_overbought and macd_cross_down
    strategy.close("BUY")
    alert("SELL: RSI=" + str.tostring(rsi, "0.00") + " MACD Crossunder", alert.freq_once_per_bar_close)

// Plot RSI on separate panel
plot(rsi, color=color.blue, title="RSI", linewidth=2)
hline(rsi_oversold, color=color.green, linestyle=hline.style_dashed, title="Oversold")
hline(rsi_overbought, color=color.red, linestyle=hline.style_dashed, title="Overbought")

// Plot MACD on separate panel
plot(macdLine, color=color.orange, title="MACD")
plot(signalLine, color=color.purple, title="Signal")
